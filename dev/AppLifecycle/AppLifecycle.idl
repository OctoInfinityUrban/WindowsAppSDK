// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.

namespace Microsoft.ProjectReunion
{
    runtimeclass AppLifecycle
    {
        static Windows.ApplicationModel.Activation.IActivatedEventArgs GetActivatedEventArgs();

        static Windows.Foundation.Collections.IVector<AppLifecycle> GetRegisteredInstances();
        static AppLifecycle FindOrRegisterInstanceForKey(String key);
        static void UnregisterInstanceForRedirection();

        void RedirectActivationTo(Windows.ApplicationModel.Activation.IActivatedEventArgs args);
        event Windows.Foundation.EventHandler<Windows.ApplicationModel.Activation.IActivatedEventArgs> Activated;

        Boolean IsCurrentInstance{ get; };
        String Key{ get; };
    }

    static runtimeclass ActivationRegistrationManager
    {
        static void RegisterForFileTypeActivation(String[] supportedFileTypes, String[] supportedVerbs,
            String applicationDisplayName, String logo);
        static void RegisterForProtocolActivation(String scheme, String applicationDisplayName, String logo);

        static void UnregisterForFileTypeActivation(String fileType);
        static void UnregisterForProtocolActivation(String scheme);
    };
}
