stages:
- stage: Test
  dependsOn: Build
  # Skip the build job if we are reusing the output of a previous build.
  # useBuildOutputFromBuildId variable is set on the Pipeline at Queue time.
  condition:
    and(eq(variables['useBuildOutputFromBuildId'],''), succeeded()
  jobs:
  # Arm64 uses a different VM type than x64, thus requiring them to be in different
  # pools, hence, we spilt the two scenarios into separate jobs.
  - template: WindowsAppSDK-RunTestsInPipeline-Job.yml@self
    parameters:
      jobName: PipelineTestsX64
      isArm64Platfrom: false
      dependsOn:
        - BuildBinaries
        - BuildMRT

  - template: WindowsAppSDK-RunTestsInPipeline-Job.yml@self
    parameters:
      jobName: PipelineTestsArm64
      isArm64Platfrom: true
      dependsOn:
        - BuildBinaries
        - BuildMRT