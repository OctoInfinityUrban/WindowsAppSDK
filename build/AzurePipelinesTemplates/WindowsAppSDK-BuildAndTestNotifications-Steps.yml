steps:
- template: WindowsAppSDK-SetupBuildEnvironment-Steps.yml

- task: PowerShell@2
  name: BuildBinaries
  inputs:
    filePath: 'BuildTransportPackage.ps1'
    arguments: -Platform "$(buildPlatform)" -Configuration "$(buildConfiguration)" -AzureBuildStep "BuildNotifications"

# Run the test locally on the Azure VM.
- task: VSTest@2
  displayName: 'test PushNotifications'
  condition: and(succeeded(), or(eq(variables['buildPlatform'], 'x86'), eq(variables['buildPlatform'], 'x64')))
  inputs:
    testSelector: 'testAssemblies'
    testAssemblyVer2: '**\PushNotificationTests.build.appxrecipe'
    searchFolder: 'BuildOutput\$(buildConfiguration)\$(buildPlatform)\PushNotificationTests'
    testRunTitle: 'test PushNotifications - $(buildPlatform)'
    platform: '$(buildPlatform)'
    configuration: '$(buildConfiguration)'
