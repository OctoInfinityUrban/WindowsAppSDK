# This file has been adapted to use as a non-OneBranch PR validation yml in the WindowsAppSDK Foundation repository
# Prior to 1.4, this file was used to build official release builds. This role has been moved to WindowsAppSDK-Foundation-Release.yml
trigger: none

resources:
  repositories:
    - repository: WindowsAppSDKConfig
      type: git
      name: ProjectReunion/WindowsAppSDKConfig
      ref: refs/heads/main

variables:
- template: WindowsAppSDK-Versions.yml
- template: WindowsAppSDK-CommonVariables.yml
- template: WindowsAppSDK-Foundation-TestConfig.yml@WindowsAppSDKConfig
- template: ..\eng\common\AzurePipelinesTemplates\WindowsAppSDK-GlobalVariables.yml

stages:
- stage: BuildInstaller
  jobs:
  - job: VerifyInstaller
    dependsOn: []
    pool:
      type: windows
      isCustom: true
      name: 'ProjectReunionESPool-2022' # This stage is purely a test stage so we will use our own pools here
    strategy:
      maxParallel: 10
      matrix:
        Release_x86:
          buildPlatform: 'x86'
          buildConfiguration: 'Release'
        Release_x64:
          buildPlatform: 'x64'
          buildConfiguration: 'Release'
        Release_arm64:
          buildPlatform: 'ARM64'
          buildConfiguration: 'Release'
    variables:
      ob_outputDirectory: '$(REPOROOT)\out'
    steps:
    - template: AzurePipelinesTemplates\WindowsAppSDK-BuildInstaller-Steps.yml@self


# - template: AzurePipelinesTemplates\WindowsAppSDK-Build-Stage.yml@self
#   parameters:
#     SignOutput: False
#     IsOneBranch: False

# - template: AzurePipelinesTemplates\WindowsAppSDK-Test-Stage.yml@self

# - template: AzurePipelinesTemplates\WindowsAppSDK-PackTransportPackage-Stage.yml@self
#   parameters:
#     SignOutput: False
#     PublishPackage: False
#     IsOneBranch: False
#     BuildMockWindowsAppSDK: False
